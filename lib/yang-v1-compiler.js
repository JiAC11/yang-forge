// Generated by CoffeeScript 1.9.1
(function() {
  var compiler, meta, output, schema;

  compiler = require('./yang-core-compiler');

  schema = (require('fs')).readFileSync(__dirname + "/../schemas/yang-v1-compiler.yang", 'utf-8');

  meta = compiler.preprocess(schema);

  meta.merge('augment', {
    resolver: function(arg, params) {
      var ref;
      if ((ref = this[arg]) != null) {
        if (typeof ref.extend === "function") {
          ref.extend(params);
        }
      }
      return null;
    }
  });

  meta.merge('import', {
    resolver: function(arg, params) {
      this.set("schema:" + params.prefix, this.get("module:" + arg));
      return null;
    }
  });

  meta.merge('include', {
    resolver: function(arg, params) {
      this.extend(this.get("submodule:" + arg));
      return null;
    }
  });

  meta.merge('belongs-to', {
    resolver: function(arg, params) {
      this.set("schema:" + params.prefix, this.get("module:" + arg));
      return null;
    }
  });

  meta.merge('refine', {
    resolver: function(arg, params) {
      var ref;
      if ((ref = this[arg]) != null) {
        if (typeof ref.extend === "function") {
          ref.extend(params);
        }
      }
      return null;
    }
  });

  meta.merge('uses', {
    resolver: function(arg, params) {
      return this.get("grouping:" + arg);
    }
  });

  meta.merge('feature', {
    meta: true
  });

  meta.merge('grouping', {
    meta: true
  });

  meta.merge('identity', {
    meta: true
  });

  meta.merge('revision', {
    meta: true
  });

  meta.merge('typedef', {
    meta: true
  });

  meta.merge('module', {
    "export": true
  });

  meta.merge('submodule', {
    "export": true
  });

  meta.merge('rpc', {
    "export": true
  });

  meta.merge('notification', {
    "export": true
  });

  output = compiler.compile(schema, {
    meta: meta
  });

  output.extend(compiler);

  module.exports = output;

}).call(this);
